unit sample

get {
    cod.Sys
}

share InteractiveDemo {
    
    // Supporting both else-if and elif
    ~| int formula, string operation
    local calculate(int a, int b, string op) {  
        if op == "+" {
           // Separate return assignments
           ~> formula a + b
           ~> operation "addition"
         } else if op == "-" {
           // One line return assignments
           ~> formula a - b, operation "subtraction"
         } else if op == "*" {
           // implicit one line return assignments
           ~> a * b, "multiplication"
         } else if op == "/" {
           // mixed one line return assignments
           ~> formula a / b, "division"
          } else {
           ~> 0, "unknown"
          }
    }

    // Method with single expression
    local add(int a, int b) ~> a + b

    ~| x, y
    local haha(int a) {
    }

    
    // Array demonstration
    local demonstrateArrays() {
        Sys.outln("=== Array Demo ===")
        
        numbers = [10, 20, 30, 40, 50]
        Sys.outln("Array: " + numbers)
        
        Sys.outln("First element: " + numbers[0] + " ")
        Sys.outa("Last element:" + numbers[4]) // testing output
        
        numbers[2] = 99
        Sys.outln("After modification: " + numbers)
    }

    // Input demonstration with ENHANCED VALIDATION
    local getUserInfo() {
        Sys.outln("=== User Registration ===")
    
        Sys.outln("Enter your name:")
        name = (string) input
    
        Sys.outln("Enter your age:")
        age = (int) input
    
        Sys.outln("Enter your height (meters):")
        height = (float) input
    
        Sys.outln("Are you a student? (true/false)")
        isStudent = (bool) input
    
        // NEW: Showcasing 'all' for comprehensive validation
        if all[
            name != "",
            age >= 0, 
            age <= 120,
            height > 0.0,
            height < 3.0
       ] {
            Sys.outln("")
            Sys.outln("Registration Complete!")
            Sys.outln("Name: " + name)
            Sys.outln("Age: " + age)
            Sys.outln("Height: " + height + "m")
            Sys.outln("Student: " + isStudent)
        
            // NEW: Showcasing 'any' for role-based greeting
            if any[isStudent, age < 25] {
                Sys.outln("Welcome young user " + name + "!")
            } else {
                Sys.outln("Welcome " + name + "!")
            }
         } else {
             Sys.outln("")
             Sys.outln(" Registration Failed: Invalid data provided!")
         }
    }

    // Calculator with user input + VALIDATION SHOWCASE
    local interactiveCalculator() {
        Sys.outln("=== Interactive Calculator ===")
    
        Sys.outln("Enter first number:")
        num1 = (int) input
    
        Sys.outln("Enter second number:")
        num2 = (int) input
    
        Sys.outln("Enter operation (+, -, *, /):")
        op = (string) input
    
        //  NEW: Showcasing conditional chains for validation!
        if op == any["+", "-", "*", "/"] {
            result, operation = [formula, operation]:calculate(num1, num2, op)
        
            Sys.outln("")
            Sys.outln("Calculation Result:")
            Sys.outln(num1 + " " + op + " " + num2 + " = " + result)
            Sys.outln("Operation: " + operation)
        } else {
            Sys.outln("")
            Sys.outln("Error: '" + op + "' is not a valid operation!")
            Sys.outln("Please use one of: +, -, *, /")
        }
    }
    
    // Loop demonstration with input
    share numberSeries() {
        Sys.outln("=== Number Series Generator ===")
        
        Sys.outln("Enter start number:")
        start = (int) input
        
        Sys.outln("Enter end number:")
        end = (int) input
        
        Sys.outln("Number series from " + start + " to " + end + ":")
        
        Sys.outln("")
        Sys.outln("=== DEFAULT STEPS (No 'by' clause) ===")
        Sys.outln("Counting up naturally:")
        for i in 1 to 5 {
            Sys.outln("Default step: " + i)  // 1, 2, 3, 4, 5
        }
        
        Sys.outln("Counting down naturally:")
        for i in 5 to 1 {
            Sys.outln("Default step: " + i)  // 5, 4, 3, 2, 1
        }
        
        Sys.outln("User range - smart default:")
        for i in start to end {
            Sys.outln("Smart default: " + i)  // auto +1 or -1 based on start/end
        }
        
        Sys.outln("")
        Sys.outln("=== BASIC STEPS ===")
        Sys.outln("Enter step size:")
        steps = (int) input
        
        for i by steps in start to end {
            Sys.outln("Step by " + steps + ": " + i)
        }
        
        // Manual assignments
        for i by i = i + 1 in start to end {
            Sys.outln("Manual i=i+1: " + i)
        }
        
        // Compound assignments  
        for i by i += 1 in start to end {
            Sys.outln("Compound i+=1: " + i)
        }
        
        // Operator prefixes
        for i by +1 in start to end {
            Sys.outln("Step by +1: " + i)
        }
        
        // Counting down with various methods
        for i by -1 in 10 to 1 {
            Sys.outln("Countdown by -1: " + i)
        }
        
        for i by i = i - 1 in 10 to 1 {
            Sys.outln("Countdown manual: " + i)
        }
        
        for i by i -= 1 in 10 to 1 {
            Sys.outln("Countdown compound: " + i)
        }
        
        Sys.outln("")
        Sys.outln("=== MULTIPLICATIVE STEPS ===")
        
        // Multiplicative patterns
        
        for i by *2 in 1 to 32 {
            Sys.outln("Doubling: " + i)
        }
        
        for i by i = i * 2 in 1 to 32 {
            Sys.outln("Doubling manual: " + i)
        }
        
        for i by i *= 2 in 1 to 32 {
            Sys.outln("Doubling compound: " + i)
        } 
        
        for i by *+2 in start to end {
            Sys.outln("Step by *+2: " + i)
        }
        
        Sys.outln("")
        Sys.outln("=== DIVISION STEPS ===")
        
        // Division patterns
        for i by /2 in 64 to 2 {
            Sys.outln("Halving: " + i)
        }
        
        for i by i = i / 2 in 64 to 2 {
            Sys.outln("Halving manual: " + i)
        }
        
        for i by i /= 2 in 64 to 2 {
            Sys.outln("Halving compound: " + i)
        }
        
        for i by /+2 in 32 to 1 {
            Sys.outln("Step by /+2: " + i)
        }
        
        Sys.outln("")
        Sys.outln("=== PRACTICAL PATTERNS ===")
        Sys.outln("Powers of 2:")
        
        // Various power patterns
        for power by *2 in 1 to 64 {
            Sys.outln("2^" + power + " = " + power)
        }
        
        for power by power *= 2 in 1 to 64 {
            Sys.outln("Power compound: " + power)
        }
        
        Sys.outln("Countdown sequences:")
        // Natural countdown
        for count in 10 to 1 {
            Sys.outln("Natural countdown: " + count)
        }
        
        // Explicit countdown
        for count by -1 in 10 to 1 {
            Sys.outln("Explicit countdown: " + count)
        }
        
        Sys.outln("Growing sequences:")
        // Complex patterns
        for grow by *2 + 1 in 1 to 50 {
            Sys.outln("Growing: " + grow)
        }
        
        for grow
        by grow = grow * 2 + 1
        in 1
        to 50 {
            Sys.outln("Growing manual: " + grow)
        }
        
        Sys.outln("Mixed operations:")
        for mixed in 1 to 20 {
            Sys.outln("Mixed default: " + mixed)
        }
        
        for mixed by +2 in 1 to 20 {
            Sys.outln("Mixed +2: " + mixed)
        }
        
        for mixed by -2 in 20 to 2 {
            Sys.outln("Mixed -2: " + mixed)
        }
    }
    
    // Additional demo for edge cases
    share edgeCaseLoops() {
        Sys.outln("=== Edge Case Loops ===")
        
        // Single element ranges
        Sys.outln("Single element:")
        for i in 5 to 5 {
            Sys.outln("Single: " + i)  // Should Sys.outln: 5
        }
        
        // Zero-step ranges
        Sys.outln("Zero range up:")
        for i in 0 to 0 {
            Sys.outln("Zero up: " + i)  // Should Sys.outln: 0
        }
        
        Sys.outln("Zero range down:")
        for i in 0 to 0 {
            Sys.outln("Zero down: " + i)  // Should Sys.outln: 0
        }
        
        // Negative numbers
        Sys.outln("Negative ranges:")
        for i in -5 to -1 {
            Sys.outln("Negative up: " + i) // -5, -4, -3, -2, -1
        }
        
        for i in -1 to -5 {
            Sys.outln("Negative down: " + i) // -1, -2, -3, -4, -5
        }
        
        // Large steps
        Sys.outln("Large steps:")
        for i by 10 in 0 to 50 {
            Sys.outln("Large step: " + i ) // 0, 10, 20, 30, 40, 50
        }
    }
    
    // Main method - program entry point
    share main() {
        Sys.outln("=== CODERIVE INTERACTIVE DEMO ===")
        Sys.outln("")
        
        // Demonstrate arrays
        demonstrateArrays()
        Sys.outln("")
        
        // Get user information
        getUserInfo() 
        Sys.outln("")
        
        // Calculator demo
        interactiveCalculator()
        Sys.outln("")
        
        // Number series demo
        numberSeries()
        Sys.outln("")
        
        // Edge cases
        edgeCaseLoops()
        Sys.outln("")
        
        Sys.outln("=== DEMO COMPLETE ===")
        Sys.outln("Thank you for using Coderive!")
    }
}